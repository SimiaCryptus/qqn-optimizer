\documentclass{article}
\usepackage{booktabs}
\usepackage{array}
\usepackage{multirow}
\usepackage{xcolor}
\usepackage{colortbl}
\usepackage{siunitx}
\usepackage{adjustbox}
\usepackage{rotating}
\usepackage{makecell}
\usepackage[margin=0.5in]{geometry}
\usepackage{longtable}
\definecolor{bestgreen}{RGB}{0,150,0}
\definecolor{worstred}{RGB}{200,0,0}
\begin{document}
\begin{longtable}{lccccc}
\caption{Optimizer Family vs Problem Family Performance Matrix}
\label{tab:family_vs_family_matrix} \\
\toprule
\makecell{Problem\\Family} & \makecell{\rotatebox{90}{\textbf{Adam}}} & \makecell{\rotatebox{90}{\textbf{GD}}} & \makecell{\rotatebox{90}{\textbf{L-BFGS}}} & \makecell{\rotatebox{90}{\textbf{QQN}}} & \makecell{\rotatebox{90}{\textbf{Trust Region}}} \\
\midrule
\endfirsthead
\multicolumn{6}{l}{\tablename\ \thetable\ -- continued from previous page} \\
\toprule
\makecell{Problem\\Family} & \makecell{\rotatebox{90}{\textbf{Adam}}} & \makecell{\rotatebox{90}{\textbf{GD}}} & \makecell{\rotatebox{90}{\textbf{L-BFGS}}} & \makecell{\rotatebox{90}{\textbf{QQN}}} & \makecell{\rotatebox{90}{\textbf{Trust Region}}} \\
\midrule
\endhead
\midrule
\multicolumn{6}{l}{Continued on next page} \\
\endfoot
\bottomrule
\endlastfoot
\textbf{Ackley} &  \makecell{16.3 / 12.0 \\ \scriptsize{Adam-AMSGrad} \\ \scriptsize{Adam-Fast}}&  \makecell{16.5 / 9.7 \\ \scriptsize{GD} \\ \scriptsize{GD-Momentum}}&  \makecell{6.5 / 2.3 \\ \scriptsize{L-BFGS} \\ \scriptsize{Conservative}}& \cellcolor{bestgreen!30} \makecell{5.1 / 1.0 \\ \scriptsize{Bisection-1} \\ \scriptsize{GoldenSection}}& \cellcolor{worstred!20} \makecell{20.7 / 13.7 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}} \\
\textbf{Barrier} &  \makecell{16.3 / 10.7 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-Fast}}&  \makecell{13.8 / 8.0 \\ \scriptsize{GD} \\ \scriptsize{AdaptiveMom...}}&  \makecell{6.5 / 2.7 \\ \scriptsize{Aggressive} \\ \scriptsize{Conservative}}& \cellcolor{bestgreen!30} \makecell{4.3 / 1.3 \\ \scriptsize{Bisection-2} \\ \scriptsize{CubicQuadIn...}}& \cellcolor{worstred!20} \makecell{19.1 / 14.0 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}} \\
\textbf{Beale} & \cellcolor{worstred!20} \makecell{19.0 / 8.0 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-Fast}}& \cellcolor{bestgreen!30} \makecell{8.8 / 3.0 \\ \scriptsize{GD-Nesterov} \\ \scriptsize{GD-Momentum}}&  \makecell{10.0 / 2.0 \\ \scriptsize{MoreThuente} \\ \scriptsize{Aggressive}}&  \makecell{8.8 / 1.0 \\ \scriptsize{GoldenSection} \\ \scriptsize{Bisection-2}}&  \makecell{18.4 / 15.0 \\ \scriptsize{Precise} \\ \scriptsize{Standard}} \\
\textbf{Booth} & \cellcolor{worstred!20} \makecell{19.2 / 11.0 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-Robust}}&  \makecell{14.6 / 10.0 \\ \scriptsize{GD} \\ \scriptsize{GD-Momentum}}&  \makecell{11.0 / 6.0 \\ \scriptsize{MoreThuente} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{3.0 / 1.0 \\ \scriptsize{CubicQuadIn...} \\ \scriptsize{GoldenSection}}&  \makecell{17.2 / 12.0 \\ \scriptsize{Adaptive} \\ \scriptsize{Conservative}} \\
\textbf{GoldsteinPrice} &  \makecell{13.2 / 10.0 \\ \scriptsize{Adam-AMSGrad} \\ \scriptsize{Adam-Fast}}&  \makecell{15.2 / 9.0 \\ \scriptsize{GD-Momentum} \\ \scriptsize{GD}}&  \makecell{10.4 / 5.0 \\ \scriptsize{MoreThuente} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{3.2 / 1.0 \\ \scriptsize{GoldenSection} \\ \scriptsize{Bisection-2}}& \cellcolor{worstred!20} \makecell{23.0 / 21.0 \\ \scriptsize{Aggressive} \\ \scriptsize{Precise}} \\
\textbf{Griewank} &  \makecell{17.7 / 12.0 \\ \scriptsize{Adam-Fast} \\ \scriptsize{Adam-Robust}}&  \makecell{12.0 / 7.7 \\ \scriptsize{GD-Momentum} \\ \scriptsize{GD}}&  \makecell{7.9 / 3.7 \\ \scriptsize{Aggressive} \\ \scriptsize{L-BFGS-Limited}}& \cellcolor{bestgreen!30} \makecell{6.3 / 1.0 \\ \scriptsize{StrongWolfe} \\ \scriptsize{CubicQuadIn...}}& \cellcolor{worstred!20} \makecell{21.1 / 13.7 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}} \\
\textbf{Himmelblau} & \cellcolor{worstred!20} \makecell{18.8 / 11.0 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-Robust}}&  \makecell{14.6 / 9.0 \\ \scriptsize{GD} \\ \scriptsize{AdaptiveMom...}}&  \makecell{11.2 / 5.0 \\ \scriptsize{L-BFGS-Limited} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{3.4 / 1.0 \\ \scriptsize{GoldenSection} \\ \scriptsize{Bisection-1}}&  \makecell{17.0 / 8.0 \\ \scriptsize{Adaptive} \\ \scriptsize{Conservative}} \\
\textbf{IllConditionedRosenbrock} &  \makecell{14.2 / 9.0 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-Robust}}&  \makecell{12.5 / 7.0 \\ \scriptsize{GD-Nesterov} \\ \scriptsize{GD-Momentum}}&  \makecell{12.5 / 4.7 \\ \scriptsize{MoreThuente} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{4.1 / 1.7 \\ \scriptsize{CubicQuadIn...} \\ \scriptsize{GoldenSection}}& \cellcolor{worstred!20} \makecell{21.8 / 16.7 \\ \scriptsize{Aggressive} \\ \scriptsize{Conservative}} \\
\textbf{Levi} &  \makecell{14.4 / 11.0 \\ \scriptsize{Adam-Robust} \\ \scriptsize{Adam-Fast}}&  \makecell{14.6 / 9.0 \\ \scriptsize{GD-Momentum} \\ \scriptsize{GD-WeightDecay}}&  \makecell{11.6 / 3.0 \\ \scriptsize{L-BFGS-Limited} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{3.8 / 1.0 \\ \scriptsize{GoldenSection} \\ \scriptsize{Bisection-1}}& \cellcolor{worstred!20} \makecell{20.6 / 13.0 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}} \\
\textbf{Levy} &  \makecell{15.9 / 10.0 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-AMSGrad}}&  \makecell{16.2 / 7.7 \\ \scriptsize{GD-WeightDecay} \\ \scriptsize{AdaptiveMom...}}&  \makecell{9.1 / 6.7 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{3.0 / 1.0 \\ \scriptsize{Bisection-2} \\ \scriptsize{StrongWolfe}}& \cellcolor{worstred!20} \makecell{20.8 / 16.0 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}} \\
\textbf{Matyas} &  \makecell{13.2 / 10.0 \\ \scriptsize{Adam-Fast} \\ \scriptsize{Adam-AMSGrad}}&  \makecell{16.0 / 12.0 \\ \scriptsize{GD-Momentum} \\ \scriptsize{AdaptiveMom...}}&  \makecell{8.8 / 3.0 \\ \scriptsize{L-BFGS} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{4.0 / 1.0 \\ \scriptsize{StrongWolfe} \\ \scriptsize{Bisection-1}}& \cellcolor{worstred!20} \makecell{23.0 / 21.0 \\ \scriptsize{Conservative} \\ \scriptsize{Precise}} \\
\textbf{Michalewicz} & \cellcolor{bestgreen!30} \makecell{6.2 / 1.0 \\ \scriptsize{Adam-Fast} \\ \scriptsize{Adam-Robust}}&  \makecell{12.1 / 6.7 \\ \scriptsize{AdaptiveMom...} \\ \scriptsize{GD-WeightDecay}}&  \makecell{14.3 / 7.0 \\ \scriptsize{MoreThuente} \\ \scriptsize{Aggressive}}&  \makecell{11.9 / 6.7 \\ \scriptsize{Bisection-2} \\ \scriptsize{CubicQuadIn...}}& \cellcolor{worstred!20} \makecell{20.5 / 16.3 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}} \\
\textbf{Neural Networks} &  \makecell{9.2 / 2.5 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-Robust}}&  \makecell{19.6 / 16.0 \\ \scriptsize{GD-WeightDecay} \\ \scriptsize{AdaptiveMom...}}&  \makecell{11.0 / 8.0 \\ \scriptsize{Conservative} \\ \scriptsize{MoreThuente}}& \cellcolor{bestgreen!30} \makecell{3.8 / 1.0 \\ \scriptsize{CubicQuadIn...} \\ \scriptsize{StrongWolfe}}& \cellcolor{worstred!20} \makecell{21.4 / 18.5 \\ \scriptsize{Adaptive} \\ \scriptsize{Aggressive}} \\
\textbf{NoisySphere} &  \makecell{16.9 / 8.7 \\ \scriptsize{Adam-Fast} \\ \scriptsize{Adam}}&  \makecell{8.8 / 5.3 \\ \scriptsize{GD-Nesterov} \\ \scriptsize{GD-WeightDecay}}& \cellcolor{bestgreen!30} \makecell{7.4 / 1.0 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}}&  \makecell{9.9 / 2.7 \\ \scriptsize{StrongWolfe} \\ \scriptsize{CubicQuadIn...}}& \cellcolor{worstred!20} \makecell{19.9 / 16.3 \\ \scriptsize{Conservative} \\ \scriptsize{Precise}} \\
\textbf{PenaltyI} &  \makecell{8.1 / 4.3 \\ \scriptsize{Adam-AMSGrad} \\ \scriptsize{Adam-Fast}}&  \makecell{12.3 / 9.7 \\ \scriptsize{GD} \\ \scriptsize{GD-Nesterov}}&  \makecell{14.3 / 5.7 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{7.5 / 1.0 \\ \scriptsize{CubicQuadIn...} \\ \scriptsize{Bisection-2}}& \cellcolor{worstred!20} \makecell{22.9 / 20.7 \\ \scriptsize{Adaptive} \\ \scriptsize{Precise}} \\
\textbf{Rastrigin} &  \makecell{11.4 / 4.7 \\ \scriptsize{Adam-AMSGrad} \\ \scriptsize{Adam-Fast}}&  \makecell{14.2 / 7.7 \\ \scriptsize{GD-WeightDecay} \\ \scriptsize{GD-Momentum}}&  \makecell{14.1 / 3.7 \\ \scriptsize{MoreThuente} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{9.9 / 3.0 \\ \scriptsize{CubicQuadIn...} \\ \scriptsize{Bisection-2}}& \cellcolor{worstred!20} \makecell{15.4 / 7.0 \\ \scriptsize{Adaptive} \\ \scriptsize{Conservative}} \\
\textbf{Regression} &  \makecell{18.5 / 13.2 \\ \scriptsize{Adam-Fast} \\ \scriptsize{Adam-Robust}}&  \makecell{13.6 / 8.2 \\ \scriptsize{AdaptiveMom...} \\ \scriptsize{GD-Momentum}}&  \makecell{8.9 / 4.8 \\ \scriptsize{Conservative} \\ \scriptsize{L-BFGS}}& \cellcolor{bestgreen!30} \makecell{3.4 / 1.0 \\ \scriptsize{Bisection-1} \\ \scriptsize{GoldenSection}}& \cellcolor{worstred!20} \makecell{20.6 / 17.2 \\ \scriptsize{Adaptive} \\ \scriptsize{Conservative}} \\
\textbf{Rosenbrock} &  \makecell{13.4 / 6.0 \\ \scriptsize{Adam-Fast} \\ \scriptsize{Adam-Robust}}&  \makecell{12.1 / 5.0 \\ \scriptsize{GD-Nesterov} \\ \scriptsize{GD-Momentum}}&  \makecell{12.6 / 4.0 \\ \scriptsize{MoreThuente} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{4.9 / 2.0 \\ \scriptsize{StrongWolfe} \\ \scriptsize{GoldenSection}}& \cellcolor{worstred!20} \makecell{22.0 / 17.7 \\ \scriptsize{Aggressive} \\ \scriptsize{Conservative}} \\
\textbf{SVM} &  \makecell{13.5 / 8.5 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-Fast}}&  \makecell{13.9 / 5.0 \\ \scriptsize{GD-WeightDecay} \\ \scriptsize{AdaptiveMom...}}&  \makecell{9.6 / 3.0 \\ \scriptsize{Conservative} \\ \scriptsize{L-BFGS-Limited}}& \cellcolor{bestgreen!30} \makecell{6.3 / 2.5 \\ \scriptsize{StrongWolfe} \\ \scriptsize{GoldenSection}}& \cellcolor{worstred!20} \makecell{21.7 / 17.0 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}} \\
\textbf{Schwefel} & \cellcolor{worstred!20} \makecell{20.1 / 10.7 \\ \scriptsize{Adam-Fast} \\ \scriptsize{Adam-Robust}}&  \makecell{10.5 / 6.7 \\ \scriptsize{GD-WeightDecay} \\ \scriptsize{GD}}&  \makecell{10.5 / 4.3 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{4.3 / 1.0 \\ \scriptsize{StrongWolfe} \\ \scriptsize{GoldenSection}}&  \makecell{19.7 / 16.7 \\ \scriptsize{Standard} \\ \scriptsize{Conservative}} \\
\textbf{SparseQuadratic} &  \makecell{18.9 / 12.5 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-AMSGrad}}&  \makecell{14.5 / 10.5 \\ \scriptsize{GD-WeightDecay} \\ \scriptsize{AdaptiveMom...}}&  \makecell{6.4 / 1.5 \\ \scriptsize{MoreThuente} \\ \scriptsize{L-BFGS}}& \cellcolor{bestgreen!30} \makecell{4.9 / 1.5 \\ \scriptsize{GoldenSection} \\ \scriptsize{Bisection-1}}& \cellcolor{worstred!20} \makecell{20.3 / 14.5 \\ \scriptsize{Precise} \\ \scriptsize{Aggressive}} \\
\textbf{SparseRosenbrock} &  \makecell{12.9 / 8.0 \\ \scriptsize{Adam-Fast} \\ \scriptsize{Adam-Robust}}&  \makecell{11.8 / 6.0 \\ \scriptsize{GD-Nesterov} \\ \scriptsize{GD-Momentum}}&  \makecell{15.2 / 4.5 \\ \scriptsize{MoreThuente} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{3.7 / 1.0 \\ \scriptsize{CubicQuadIn...} \\ \scriptsize{Bisection-2}}& \cellcolor{worstred!20} \makecell{21.4 / 19.0 \\ \scriptsize{Standard} \\ \scriptsize{Conservative}} \\
\textbf{Sphere} & \cellcolor{worstred!20} \makecell{20.1 / 14.5 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-AMSGrad}}&  \makecell{13.9 / 10.0 \\ \scriptsize{GD-Momentum} \\ \scriptsize{AdaptiveMom...}}&  \makecell{6.1 / 1.0 \\ \scriptsize{Aggressive} \\ \scriptsize{Conservative}}& \cellcolor{bestgreen!30} \makecell{5.3 / 3.0 \\ \scriptsize{StrongWolfe} \\ \scriptsize{GoldenSection}}&  \makecell{19.6 / 14.0 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}} \\
\textbf{StyblinskiTang} & \cellcolor{worstred!20} \makecell{16.6 / 4.3 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-Robust}}&  \makecell{14.2 / 7.3 \\ \scriptsize{GD-WeightDecay} \\ \scriptsize{AdaptiveMom...}}&  \makecell{10.3 / 2.3 \\ \scriptsize{Conservative} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{8.7 / 1.7 \\ \scriptsize{GoldenSection} \\ \scriptsize{StrongWolfe}}&  \makecell{15.3 / 4.3 \\ \scriptsize{Standard} \\ \scriptsize{Conservative}} \\
\textbf{Trigonometric} &  \makecell{12.7 / 7.3 \\ \scriptsize{Adam} \\ \scriptsize{Adam-Fast}}&  \makecell{14.3 / 5.0 \\ \scriptsize{GD} \\ \scriptsize{GD-Momentum}}&  \makecell{12.7 / 5.3 \\ \scriptsize{MoreThuente} \\ \scriptsize{Aggressive}}& \cellcolor{bestgreen!30} \makecell{4.0 / 1.0 \\ \scriptsize{CubicQuadIn...} \\ \scriptsize{Bisection-2}}& \cellcolor{worstred!20} \makecell{21.3 / 17.7 \\ \scriptsize{Precise} \\ \scriptsize{Aggressive}} \\
\textbf{Zakharov} &  \makecell{13.4 / 9.3 \\ \scriptsize{WeightDecay} \\ \scriptsize{Adam-Robust}}&  \makecell{14.7 / 7.3 \\ \scriptsize{GD} \\ \scriptsize{AdaptiveMom...}}&  \makecell{11.7 / 6.0 \\ \scriptsize{MoreThuente} \\ \scriptsize{L-BFGS}}& \cellcolor{bestgreen!30} \makecell{3.0 / 1.0 \\ \scriptsize{Bisection-1} \\ \scriptsize{StrongWolfe}}& \cellcolor{worstred!20} \makecell{22.2 / 19.0 \\ \scriptsize{Adaptive} \\ \scriptsize{Conservative}} \\
\end{longtable}
\vspace{0.5em}
\textbf{Legend:} Each cell contains:
\begin{itemize}
\item \textbf{Top line:} Average Ranking / Best Rank Average (lower is better)
\item \textbf{Middle line:} Best performing variant in this optimizer family
\item \textbf{Bottom line:} Worst performing variant in this optimizer family
\end{itemize}
\textcolor{bestgreen}{Green cells} indicate the best performing optimizer family for that problem family.
\textcolor{worstred}{Red cells} indicate the worst performing optimizer family.
\end{document}
